{"version":3,"file":"815.js","mappings":"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","sources":["webpack://@dev/web/./src/containers/Moto/styles.module.scss?c757","webpack://@dev/web/./src/containers/Moto/index.tsx","webpack://@dev/web/./src/containers/Moto/styles.module.scss","webpack://@dev/web/../../node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js","webpack://@dev/web/../../node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js","webpack://@dev/web/../../node_modules/rxjs/dist/esm5/internal/operators/map.js"],"sourcesContent":["\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, {\n  ChangeEventHandler,\n  Dispatch,\n  SetStateAction,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { Subject } from \"rxjs\";\nimport { debounceTime, distinctUntilChanged, map } from \"rxjs/operators\";\nimport { createAsset } from \"use-asset\";\nimport { format } from \"date-fns\";\nimport type { ItemType } from \"@dev/cli/src/services/MotoService/types\";\nimport { Gallery } from \"../../components/Gallery\";\nimport { Link } from \"../../components/Link\";\nimport styles from \"./styles.module.scss\";\n\ninterface FiltersState {\n  search: string;\n}\n\nconst asset = createAsset(async (version) => {\n  const res = await fetch(`api/moto/data.json?${version}`);\n  return await res.json().then((list) => list);\n});\n\nfunction Vehicle({ item }: { item: ItemType }) {\n  return (\n    <div className={styles.Vehicle}>\n      {item.thumbnail && (\n        <Gallery className={styles.Gallery} images={[item.thumbnail]} />\n      )}\n      <div className={styles.Right}>\n        <div>{format(new Date(item._created), \"yyyy-MM-dd HH:mm\")}</div>\n        <span className={styles.Price}>{`${new Intl.NumberFormat(\"pl-PL\", {\n          minimumFractionDigits: 2,\n        }).format(item.price)} PLN`}</span>\n      </div>\n      <Link href={item.url}>{`[${item.id}] ${item.title}`}</Link>\n      {/* <pre>{JSON.stringify(item, null, 2)}</pre> */}\n    </div>\n  );\n}\n\nconst LIMIT = 25;\n\nfunction Vehicles({ vehicles }: { vehicles: ItemType[] }) {\n  const [limit, setLimit] = useState(() => LIMIT);\n\n  return (\n    <div>\n      {useMemo(() => vehicles.slice(0, limit), [limit, vehicles]).map(\n        (item, key) => (\n          <div key={key} className={styles.Row}>\n            <Vehicle item={item} />\n          </div>\n        )\n      )}\n      {vehicles.length > limit && (\n        <Link\n          onClick={(e) => (e.preventDefault(), setLimit((limit) => limit + 25))}\n        >\n          {`${vehicles.length - limit} wiÄ™cej...`}\n        </Link>\n      )}\n    </div>\n  );\n}\n\nfunction Results({\n  results,\n  queries,\n}: {\n  results: ItemType[];\n  queries: FiltersState;\n}) {\n  return (\n    <Vehicles\n      vehicles={results.filter(\n        (item) =>\n          queries.search === \"\" ||\n          item.title.toLowerCase().match(queries.search)\n      )}\n    />\n  );\n}\n\nfunction Filters({\n  filters,\n  setFilters,\n}: {\n  filters: FiltersState;\n  setFilters: Dispatch<SetStateAction<FiltersState>>;\n}) {\n  return (\n    <fieldset>\n      <label>\n        <span>Search</span>\n        <input\n          type=\"search\"\n          value={filters.search}\n          onChange={useCallback<ChangeEventHandler<HTMLInputElement>>(\n            ({ target }) =>\n              setFilters((filters) => ({\n                ...filters,\n                search: target.value,\n              })),\n            []\n          )}\n        />\n      </label>\n    </fieldset>\n  );\n}\n\nexport default function Section({ version = \"v1\" }) {\n  const { results } = asset.read(version) as {\n    results: ItemType[];\n  };\n\n  const [filters, setFilters] = useState<FiltersState>(() => ({\n    search: \"\",\n  }));\n\n  const [queries, setQueries] = useState(() => filters);\n\n  const search$ = useMemo(() => new Subject<any>(), []);\n\n  useEffect(() => {\n    const subscription = search$\n      .pipe(\n        map(({ search, ...filters }) =>\n          JSON.stringify({\n            ...queries,\n            ...filters,\n            search: search.toLowerCase().trim(),\n          })\n        ),\n        distinctUntilChanged(),\n        debounceTime(400)\n      )\n      .subscribe((filters) =>\n        setQueries((queries) => ({ ...queries, ...JSON.parse(filters) }))\n      );\n    return () => subscription.unsubscribe();\n  }, [search$]);\n\n  useEffect(() => {\n    search$.next(filters);\n  }, [filters]);\n\n  console.log({ results, filters, queries });\n\n  return (\n    <div className={styles.Section}>\n      <h2>Moto</h2>\n      <Filters filters={filters} setFilters={setFilters} />\n      <Results results={results} queries={queries} />\n    </div>\n  );\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".TfWARmFhLqg_MOcTWbpL{color:purple;padding:1em}.QZT6UQY5cm6U5k_z9hxm{position:relative;min-height:80px;padding:.5em 1em .5em calc(100px + 1em);border-top:1px solid #d3d3d3}.ds_YhOTr3dnRvhOJzvIo{position:absolute;top:.5em;left:.5em;width:95px;height:80px;border:1px solid #d3d3d3}.MlqNs0DjtGoWhggwcx3d .bLqOEXlzLuU0tiCKKvPA{float:right;text-align:right}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/containers/Moto/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,YAAA,CACA,WAAA,CAEF,sBACE,iBAAA,CACA,eAAA,CACA,uCAAA,CACA,4BAAA,CAEF,sBACE,iBAAA,CACA,QAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,wBAAA,CAGA,4CACE,WAAA,CACA,gBAAA\",\"sourcesContent\":[\".Section {\\n  color: purple;\\n  padding: 1em;\\n}\\n.Row {\\n  position: relative;\\n  min-height: 80px;\\n  padding: 0.5em 1em 0.5em calc(100px + 1em);\\n  border-top: 1px solid lightgray;\\n}\\n.Gallery {\\n  position: absolute;\\n  top: 0.5em;\\n  left: 0.5em;\\n  width: 95px;\\n  height: 80px;\\n  border: 1px solid lightgray;\\n}\\n.Vehicle {\\n  .Right {\\n    float: right;\\n    text-align: right;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"TfWARmFhLqg_MOcTWbpL\",\n\t\"Row\": \"QZT6UQY5cm6U5k_z9hxm\",\n\t\"Gallery\": \"ds_YhOTr3dnRvhOJzvIo\",\n\t\"Vehicle\": \"MlqNs0DjtGoWhggwcx3d\",\n\t\"Right\": \"bLqOEXlzLuU0tiCKKvPA\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function debounceTime(dueTime, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return operate(function (source, subscriber) {\n        var activeTask = null;\n        var lastValue = null;\n        var lastTime = null;\n        var emit = function () {\n            if (activeTask) {\n                activeTask.unsubscribe();\n                activeTask = null;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        function emitWhenIdle() {\n            var targetTime = lastTime + dueTime;\n            var now = scheduler.now();\n            if (now < targetTime) {\n                activeTask = this.schedule(undefined, targetTime - now);\n                subscriber.add(activeTask);\n                return;\n            }\n            emit();\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            lastValue = value;\n            lastTime = scheduler.now();\n            if (!activeTask) {\n                activeTask = scheduler.schedule(emitWhenIdle, dueTime);\n                subscriber.add(activeTask);\n            }\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = activeTask = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounceTime.js.map","import { identity } from '../util/identity';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function distinctUntilChanged(comparator, keySelector) {\n    if (keySelector === void 0) { keySelector = identity; }\n    comparator = comparator !== null && comparator !== void 0 ? comparator : defaultCompare;\n    return operate(function (source, subscriber) {\n        var previousKey;\n        var first = true;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var currentKey = keySelector(value);\n            if (first || !comparator(previousKey, currentKey)) {\n                first = false;\n                previousKey = currentKey;\n                subscriber.next(value);\n            }\n        }));\n    });\n}\nfunction defaultCompare(a, b) {\n    return a === b;\n}\n//# sourceMappingURL=distinctUntilChanged.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","asset","createAsset","version","fetch","res","json","then","list","Vehicle","item","className","styles","thumbnail","Gallery","images","format","Date","_created","Intl","NumberFormat","minimumFractionDigits","price","Link","href","url","id","title","Vehicles","vehicles","useState","limit","setLimit","useMemo","slice","map","key","length","onClick","e","preventDefault","Results","results","queries","filter","search","toLowerCase","match","Filters","filters","setFilters","type","value","onChange","useCallback","target","Section","read","setQueries","search$","Subject","useEffect","subscription","pipe","JSON","stringify","trim","distinctUntilChanged","debounceTime","subscribe","parse","unsubscribe","next","console","log","___CSS_LOADER_EXPORT___","push","module","locals","dueTime","scheduler","source","subscriber","activeTask","lastValue","lastTime","emit","emitWhenIdle","targetTime","now","this","schedule","add","complete","comparator","keySelector","defaultCompare","previousKey","first","currentKey","a","b","project","thisArg","index","call"],"sourceRoot":""}