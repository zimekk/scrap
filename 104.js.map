{"version":3,"file":"104.js","mappings":"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","sources":["webpack://@dev/web/./src/components/ZoomableLineChart/styles.module.scss?37a4","webpack://@dev/web/./src/components/ZoomableLineChart/index.tsx","webpack://@dev/web/./src/hooks/useResizeObserver.ts","webpack://@dev/web/./src/components/ZoomableLineChart/styles.module.scss"],"sourcesContent":["\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, {\n  ReactNode,\n  createContext,\n  useContext,\n  useEffect,\n  useId,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport {\n  ZoomTransform,\n  area,\n  bisector,\n  brushX,\n  extent,\n  group,\n  pointer,\n  select,\n  selectAll,\n  scaleLinear,\n  scaleOrdinal,\n  scaleTime,\n  line,\n  curveCardinal,\n  axisBottom,\n  axisLeft,\n  zoom,\n  zoomIdentity,\n  brushSelection,\n  timeMonth,\n} from \"d3\";\nimport { format } from \"date-fns\";\nimport { Subject, of } from \"rxjs\";\nimport { delay, switchMap } from \"rxjs/operators\";\nimport useResizeObserver from \"../../hooks/useResizeObserver\";\nimport cx from \"classnames\";\nimport styles from \"./styles.module.scss\";\n\nconst ZoomContext = createContext<any>(undefined);\n\nexport function SyncZoomProvider({ children }: { children: ReactNode }) {\n  const events$ = useMemo(() => new Subject<any>(), []);\n  return (\n    <ZoomContext.Provider value={events$}>{children}</ZoomContext.Provider>\n  );\n}\n\n// https://github.com/muratkemaldar/using-react-hooks-with-d3/tree/16-zoomable-line-chart\nexport default function Chart({\n  legend = false,\n  list,\n  move,\n  type = \"line\",\n  rule = false,\n}: {\n  legend?: boolean;\n  list: { group: string; date: Date; value: number; value2?: number }[];\n  move?: boolean;\n  type?: \"line\" | \"area\";\n  rule?: boolean;\n}) {\n  const stream$ = useMemo(() => new Subject<any>(), []);\n  const events$ = useContext(ZoomContext) || stream$;\n  const id = useId();\n  const svgRef = useRef<SVGSVGElement>(null);\n  const tooltipRef = useRef<HTMLDivElement>(null);\n  const wrapperRef = useRef<HTMLDivElement>(null);\n  const dimensions = useResizeObserver(wrapperRef);\n  const [currentZoomState, setCurrentZoomState] = useState<ZoomTransform>();\n  const [selected, setSelected] = useState<object | null>(null);\n  const tooltip$ = useMemo(\n    () => new Subject<{ x: number; y: number; data: object } | null>(),\n    []\n  );\n\n  useEffect(() => {\n    const tooltip = select(tooltipRef.current)\n      .style(\"opacity\", 0)\n      .style(\"pointer-events\", \"none\");\n\n    const subscription = tooltip$\n      .pipe(\n        switchMap((selected) => of(selected).pipe(delay(selected ? 0 : 400)))\n      )\n      .subscribe((selected) => {\n        // console.log({selected})\n        if (selected) {\n          const margin = { x: 30, y: 30 };\n          const { x, y, data } = selected;\n\n          const wrapperRect = wrapperRef.current.getBoundingClientRect();\n          const tooltipRect = tooltipRef.current.getBoundingClientRect();\n\n          const transform = `translate(${\n            x +\n            (x < wrapperRect.width - tooltipRect.width - margin.x\n              ? margin.x\n              : -margin.x - tooltipRect.width)\n          }px,${\n            y +\n            (y < wrapperRect.height - tooltipRect.height - margin.y\n              ? margin.y\n              : margin.y - tooltipRect.height)\n          }px)`;\n\n          if (tooltip.style(\"opacity\") === \"0\") {\n            tooltip.style(\"transform\", transform);\n          }\n\n          tooltip\n            .transition()\n            .duration(300)\n            .style(\"opacity\", 0.9)\n            .style(\"transform\", transform);\n\n          setSelected(data);\n        } else {\n          tooltip.transition().duration(300).style(\"opacity\", 0);\n        }\n      });\n    return () => subscription.unsubscribe();\n  }, [tooltip$]);\n\n  const data = useMemo(() => group(list, (item) => item.group), [list]);\n  // console.log({ data });\n\n  useEffect(() => {\n    if (!wrapperRef.current || !svgRef.current) {\n      return;\n    }\n    // https://github.com/d3/d3-axis/blob/v3.0.0/README.md#axis_tickSizeInner\n    // https://observablehq.com/@d3/styled-axes?collection=@d3/d3-axis\n    const margin = {\n      top: 10,\n      bottom: 10,\n      left: 10,\n      right: 10,\n    };\n    const svg = select<Element, unknown>(svgRef.current);\n    const svgContent = svg.select(\".content\");\n    const { width, height } =\n      dimensions || wrapperRef.current.getBoundingClientRect();\n\n    // scales + line generator\n    const xScale = scaleTime()\n      .domain(extent(list, (d) => d.date))\n      .range([margin.left, width - margin.right]);\n\n    if (currentZoomState) {\n      const newXScale = currentZoomState.rescaleX(xScale);\n      xScale.domain(newXScale.domain());\n    }\n\n    const yScale = scaleLinear()\n      // .domain([0, max(list, (d) => d.value)])\n      .domain(\n        extent(\n          list\n            .map(({ value }) => value)\n            .concat(type === \"area\" ? list.map(({ value2 }) => value2) : [])\n        )\n      )\n      .range([height - margin.bottom, margin.top]);\n\n    const lineGenerator = line()\n      .x((d) => xScale(d.date))\n      .y((d) => yScale(d.value))\n      .curve(curveCardinal);\n\n    // https://d3-graph-gallery.com/graph/stackedarea_basic.html\n    // https://d3-graph-gallery.com/graph/stackedarea_template.html\n    var areaGenerator = area()\n      .x(function (d) {\n        return xScale(d.date);\n      })\n      .y0(function (d) {\n        return yScale(d.value);\n      })\n      .y1(function (d) {\n        return yScale(d.value2);\n      });\n\n    const color = scaleOrdinal()\n      .domain(Array.from(data.keys(), String))\n      .range([\n        \"#e41a1c\",\n        \"#377eb8\",\n        \"#4daf4a\",\n        \"#984ea3\",\n        \"#ff7f00\",\n        \"#ffff33\",\n        \"#a65628\",\n        \"#f781bf\",\n        \"#999999\",\n      ]);\n\n    // render the line\n    svgContent\n      .selectAll(\".myLine\")\n      .data(data)\n      .join(\"path\")\n      .attr(\"class\", \"myLine\")\n      .attr(\"stroke\", (d) => color(d[0]))\n      .attr(\"fill-opacity\", \"0.5\")\n      .attr(\"fill\", (d) => (type === \"area\" ? color(d[0]) : \"none\"))\n      .attr(\"d\", (d) =>\n        type === \"area\" ? areaGenerator(d[1]) : lineGenerator(d[1])\n      );\n\n    svgContent\n      .selectAll(\".myDot\")\n      .data(\n        (([start, end]) => timeMonth.count(start, end))(xScale.domain()) > 6\n          ? []\n          : list\n      )\n      .join(\"circle\")\n      .attr(\"class\", \"myDot\")\n      .attr(\"stroke\", \"black\")\n      .attr(\"r\", 3)\n      .attr(\"fill\", (d) => color(d.group))\n      .attr(\"cx\", (d) => xScale(d.date))\n      .attr(\"cy\", (d) => yScale(d.value))\n      .on(\"mouseenter\", (_, data) => {\n        const x = xScale(data.date);\n        const y = yScale(data.value);\n        tooltip$.next({ x, y, data });\n      })\n      .on(\"mouseleave\", () => {\n        tooltip$.next(null);\n      });\n\n    // axes\n    const xAxis = axisBottom(xScale).tickSizeInner(\n      margin.top + margin.bottom - height\n    );\n    svg\n      .select<SVGGElement>(\".x-axis\")\n      .attr(\"transform\", `translate(0, ${height})`)\n      .call(xAxis)\n      .call((g) =>\n        g\n          .selectAll(\".tick line\")\n          .attr(\"transform\", `translate(0,${-margin.bottom})`)\n          .attr(\"stroke-opacity\", 0.5)\n          .attr(\"stroke-dasharray\", \"2,2\")\n      );\n\n    const yAxis = axisLeft(yScale).tickSizeInner(\n      margin.left + margin.right - width\n    );\n    svg\n      .select<SVGGElement>(\".y-axis\")\n      .call(yAxis)\n      .call((g) =>\n        g\n          .selectAll(\".tick line\")\n          .attr(\"transform\", `translate(${margin.left},0)`)\n          .attr(\"stroke-opacity\", 0.5)\n          .attr(\"stroke-dasharray\", \"2,2\")\n      );\n\n    // brush\n    const brush = brushX()\n      .extent([\n        [0, 0],\n        [width, height],\n      ])\n      .on(\"start brush end\", ({ sourceEvent, selection }) => {\n        if (selection) {\n          // console.log('brush.event', sourceEvent)\n          if (sourceEvent) {\n            events$.next({\n              type: \"select\",\n              selection,\n            });\n          }\n        }\n      });\n\n    // zoom\n    const zoomBehavior = zoom()\n      .scaleExtent([1, 20])\n      .translateExtent([\n        [0, 0],\n        [width, height],\n      ])\n      .on(\"zoom\", ({ sourceEvent, transform }) => {\n        // console.log('zoom.event', sourceEvent)\n        events$.next({\n          type: \"zoom\",\n          sourceEvent,\n          transform,\n        });\n      });\n\n    if (move) {\n      svg\n        .select<SVGGElement>(\".brush\")\n        .call(brush)\n        .on(\"dblclick\", function () {\n          // https://observablehq.com/@d3/double-click-brush-clear\n          // const selection = brushSelection(this) ? null : xScale.range();\n          const selection = brushSelection(this) ? null : [0, width];\n          select(this).call(brush.move, selection);\n        });\n    } else {\n      svg.call(zoomBehavior);\n    }\n\n    const cities = color.domain();\n\n    if (legend) {\n      const labels = svg\n        .select<SVGGElement>(\".legend\")\n        .selectAll(\".label\")\n        .data(cities)\n        .join((enter) => {\n          const label = enter.append(\"g\").style(\"color\", (d) => color(d));\n\n          label.append(\"circle\").attr(\"fill\", \"currentColor\").attr(\"r\", 7);\n\n          label\n            .append(\"text\")\n            .attr(\"transform\", \"translate(10,3)\")\n            .text((d) => `${d}`);\n\n          return label;\n        })\n        .attr(\"class\", \"label\")\n        .attr(\n          \"transform\",\n          (_, i) =>\n            `translate(${\n              margin.left +\n              ((width - margin.left - margin.right) / cities.length) * (i + 0.2)\n            },${height * 0.05})`\n        );\n    }\n\n    // https://bl.ocks.org/larsenmtl/e3b8b7c2ca4787f77d78f58d41c3da91\n    if (rule) {\n      // var cities = color.domain().map(function(name) {\n      //   return {\n      //     name: name,\n      //     values: data.map(function(d) {\n      //       return {\n      //         date: d.date,\n      //         temperature: +d[name]\n      //       };\n      //     })\n      //   };\n      // });\n      const cursor = svg.select<SVGGElement>(\".cursor\").style(\"opacity\", \"0\");\n\n      cursor\n        .selectAll(\".mouse-line\")\n        .data([0])\n        .join(\"path\")\n        .attr(\"class\", \"mouse-line\")\n        .style(\"stroke\", \"black\")\n        .style(\"stroke-width\", \"1px\")\n        .style(\"stroke-dasharray\", \"1,1\");\n\n      cursor\n        .selectAll(\".mouse-text\")\n        .data([0])\n        .join(\"text\")\n        .attr(\"class\", \"mouse-text\")\n        .attr(\"transform\", \"translate(10,3)\")\n        .attr(\"filter\", \"url(#bg-text)\")\n        .style(\"fill\", \"black\")\n        .style(\"font\", \"11px arial\");\n\n      const mousePerLine = cursor\n        .selectAll(\".mouse-per-line\")\n        .data(cities)\n        .enter()\n        .append(\"g\")\n        .attr(\"class\", \"mouse-per-line\")\n        .style(\"color\", (d) => color(d));\n\n      mousePerLine\n        .append(\"circle\")\n        .attr(\"r\", 6)\n        .style(\"stroke\", \"currentColor\")\n        .style(\"fill\", \"none\")\n        .style(\"stroke-width\", \"1px\");\n\n      mousePerLine\n        .append(\"text\")\n        .attr(\"transform\", \"translate(10,3)\")\n        .attr(\"filter\", \"url(#bg-text)\")\n        .style(\"fill\", \"black\")\n        .style(\"font\", \"11px arial\");\n\n      svg\n        .select<SVGRectElement>(\".mouse\")\n        .attr(\"width\", width) // can't catch mouse events on a g element\n        .attr(\"height\", height)\n        .attr(\"fill\", \"none\")\n        .attr(\"pointer-events\", \"all\")\n        .on(\"mouseout\", function () {\n          // on mouse out hide line, circles and text\n          // console.log([\"mouseout\"]);\n          select(\".cursor\").style(\"opacity\", \"0\");\n        })\n        .on(\"mouseover\", function () {\n          // on mouse in show line, circles and text\n          // console.log([\"mouseover\"]);\n          select(\".cursor\").style(\"opacity\", \"1\");\n        })\n        .on(\"mousemove\", function (event) {\n          // mouse moving over canvas\n          const [x, y] = pointer(event);\n          // console.log([\"mousemove\"], x, y);\n          select(\".mouse-line\").attr(\"d\", () => `M${x},${height} ${x},${0}`);\n          selectAll(\".mouse-per-line\").attr(\n            \"transform\",\n            function (d: any, i: number): string {\n              const xDate = xScale.invert(x);\n              const values = data.get(d);\n              if (!values) {\n                return \"\";\n              }\n              const bisect = bisector((d: { date: Date }) => d.date).center;\n              const idx = bisect(values, xDate);\n              const item = values[idx];\n              const y = yScale(item.value);\n              select(this).select(\"text\").text(`${item.value}`);\n              if (!i) {\n                select(\".mouse-text\").text(\n                  format(item.date, \"dd.MM.yyyy HH:mm\")\n                );\n              }\n              return \"translate(\" + xScale(item.date) + \",\" + y + \")\";\n            }\n          );\n        });\n    }\n\n    const subscription = events$.subscribe((action) => {\n      if (move) {\n        if (action.type === \"zoom\") {\n          const { sourceEvent, transform } = action;\n          if (sourceEvent) {\n            // const selection = xScale.range().map(transform.invertX, transform)\n            const selection = [0, width].map(transform.invertX, transform);\n            svg.select<SVGGElement>(\".brush\").call(brush.move, selection);\n          }\n        }\n      } else {\n        if (action.type === \"zoom\") {\n          const { sourceEvent, transform } = action;\n          if (svgRef.current && sourceEvent) {\n            if (!svgRef.current.contains(sourceEvent.target)) {\n              svg.call(zoomBehavior.transform, transform);\n            }\n          }\n          setCurrentZoomState(transform);\n        } else if (action.type === \"select\") {\n          const { selection } = action;\n          if (selection[1] > selection[0]) {\n            // const indexSelection = selection.map(xScale.invert);\n            svg\n              .call(zoomBehavior)\n              .call(\n                zoomBehavior.transform,\n                zoomIdentity\n                  .scale(width / (selection[1] - selection[0]))\n                  .translate(-selection[0], 0)\n              );\n          }\n        }\n      }\n    });\n    return () => subscription.unsubscribe();\n  }, [currentZoomState, data, dimensions, move, events$]);\n\n  return (\n    <div className={cx(styles.Chart)} ref={wrapperRef}>\n      <div ref={tooltipRef} className={styles.Tooltip}>\n        {selected && <pre>{JSON.stringify(selected, null, 2)}</pre>}\n      </div>\n      <svg\n        ref={svgRef}\n        style={\n          move\n            ? {\n                height: 150,\n              }\n            : {}\n        }\n      >\n        <defs>\n          <clipPath id={id}>\n            <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" />\n          </clipPath>\n          <filter x=\"0\" y=\"0\" width=\"1\" height=\"1\" id=\"bg-text\">\n            <feFlood floodColor=\"rgba(255,255,255,0.75)\" />\n            <feMerge>\n              <feMergeNode in=\"bg\" />\n              <feMergeNode in=\"SourceGraphic\" />\n            </feMerge>{\" \"}\n          </filter>\n        </defs>\n        <g className=\"content\" clipPath={`url(#${id})`}></g>\n        <g className=\"x-axis\" />\n        <g className=\"y-axis\" />\n        <g className=\"brush\" />\n        <g className=\"legend\" />\n        <g className=\"cursor\" />\n        <rect className=\"mouse\" />\n      </svg>\n    </div>\n  );\n}\n","import { RefObject, useEffect, useState } from \"react\";\nimport ResizeObserver from \"resize-observer-polyfill\";\n\n// https://github.com/muratkemaldar/using-react-hooks-with-d3/blob/16-zoomable-line-chart/src/useResizeObserver.js\nexport default function useResizeObserver(ref: RefObject<Element>) {\n  const [dimensions, setDimensions] = useState<DOMRect | null>(null);\n  useEffect(() => {\n    const observeTarget = ref.current;\n    if (observeTarget) {\n      const resizeObserver = new ResizeObserver((entries) => {\n        entries.forEach((entry) => {\n          setDimensions(entry.contentRect);\n        });\n      });\n      resizeObserver.observe(observeTarget);\n      return () => {\n        resizeObserver.unobserve(observeTarget);\n      };\n    }\n  }, [ref]);\n  return dimensions;\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".TM2RQ5NCM80BeuU4weFg{position:relative;padding:2em}.TM2RQ5NCM80BeuU4weFg svg{display:block;width:100%;height:300px;background:#f7f7f7;overflow:visible}.TM2RQ5NCM80BeuU4weFg svg rect.D6JO0K0U9pALPDqqDDkn{stroke:none}.TM2RQ5NCM80BeuU4weFg svg .d3pFeUS0CMMgf0_zItXX text{font:11px arial;color:#000}.TM2RQ5NCM80BeuU4weFg .My38BlBqUTAUd9UrSUrO{position:absolute}.My38BlBqUTAUd9UrSUrO{background:#fff;border:1px solid #d3d3d3;color:orange;padding:.25em}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/ZoomableLineChart/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,iBAAA,CACA,WAAA,CAEA,0BACE,aAAA,CACA,UAAA,CACA,YAAA,CACA,kBAAA,CACA,gBAAA,CAEA,oDACE,WAAA,CAGA,qDACE,eAAA,CACA,UAAA,CAKN,4CACE,iBAAA,CAGJ,sBACE,eAAA,CACA,wBAAA,CACA,YAAA,CACA,aAAA\",\"sourcesContent\":[\".Chart {\\n  position: relative;\\n  padding: 2em;\\n\\n  svg {\\n    display: block;\\n    width: 100%;\\n    height: 300px;\\n    background: #f7f7f7;\\n    overflow: visible;\\n\\n    rect.selection {\\n      stroke: none;\\n    }\\n    .mouse-per-line {\\n      text {\\n        font: 11px arial;\\n        color: black;\\n      }\\n    }\\n  }\\n\\n  .Tooltip {\\n    position: absolute;\\n  }\\n}\\n.Tooltip {\\n  background: white;\\n  border: 1px solid lightgray;\\n  color: orange;\\n  padding: 0.25em;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Chart\": \"TM2RQ5NCM80BeuU4weFg\",\n\t\"selection\": \"D6JO0K0U9pALPDqqDDkn\",\n\t\"mouse-per-line\": \"d3pFeUS0CMMgf0_zItXX\",\n\t\"Tooltip\": \"My38BlBqUTAUd9UrSUrO\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","ZoomContext","createContext","SyncZoomProvider","children","events$","useMemo","Subject","Provider","value","Chart","legend","list","move","type","rule","stream$","useContext","id","useId","svgRef","useRef","tooltipRef","wrapperRef","dimensions","ref","useState","setDimensions","useEffect","observeTarget","current","resizeObserver","ResizeObserver","entries","forEach","entry","contentRect","observe","unobserve","useResizeObserver","currentZoomState","setCurrentZoomState","selected","setSelected","tooltip$","tooltip","select","style","subscription","pipe","switchMap","of","delay","subscribe","margin","x","y","data","wrapperRect","getBoundingClientRect","tooltipRect","transform","width","height","transition","duration","unsubscribe","group","item","svg","svgContent","xScale","scaleTime","domain","extent","d","date","range","newXScale","rescaleX","start","end","yScale","scaleLinear","map","concat","value2","lineGenerator","line","curve","curveCardinal","areaGenerator","area","y0","y1","color","scaleOrdinal","Array","from","keys","String","selectAll","join","attr","timeMonth","on","_","next","xAxis","axisBottom","tickSizeInner","call","g","yAxis","axisLeft","brush","brushX","sourceEvent","selection","zoomBehavior","zoom","scaleExtent","translateExtent","brushSelection","this","cities","enter","label","append","text","i","length","cursor","mousePerLine","event","pointer","xDate","invert","values","get","bisect","bisector","center","format","action","invertX","contains","target","zoomIdentity","translate","className","cx","styles","JSON","stringify","floodColor","in","clipPath","___CSS_LOADER_EXPORT___","push","module","locals"],"sourceRoot":""}