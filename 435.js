"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[435],{8435:(e,t,l)=>{l.r(t),l.d(t,{default:()=>z});var a=l(2784),n=l(357),r=l(9635),o=l(2779),i=l.n(o),s=l(1148),c=l(5120),u=l(2335),d=l(6982),m=l(4437);const{width:p,height:f,left:h,right:g,top:v,bottom:b}={width:320,height:200,left:10,right:10,top:20,bottom:20},E={id:"id",station_id:"station_id",network_id:"network_id",_petrol_on:"_petrol_on",_petrol_pb:"_petrol_pb",_created:"_created",_updated:"_updated"};function y({list:e}){const[t,l]=(0,a.useState)(null),[{xProp:n,yProp:o},y]=(0,a.useState)((()=>({xProp:"network_id",yProp:"_petrol_pb"}))),k=(0,a.useRef)(null),_=(0,a.useRef)(null),S=(0,a.useRef)(null),w=(0,a.useMemo)((()=>new s.x),[]);return(0,a.useEffect)((()=>{const e=w.pipe((0,u.w)((e=>(0,c.of)(e).pipe((0,d.g)(e?0:800))))).subscribe((e=>l(e)));return()=>e.unsubscribe()}),[w]),(0,a.useEffect)((()=>{const t=e.filter((({item:e})=>e[n]&&e[o])).slice(0,2e3).map((({item:e})=>[e[n],e[o],`[${e.id}] ${e.network_name} (${e[n]} / ${e[o]})`])),l=t.map((([e=0])=>e)),a=t.map((([,e=0])=>e)),i=[Math.min(...l),Math.max(...l)],s=[Math.min(...a),Math.max(...a)],c=(0,r.BYU)().domain(i).range([h,p-g]),u=(0,r.BYU)().domain(s).range([f-b,v]),d=(0,r.BYU)().domain(i).range(["red","blue"]);(0,r.Ys)(S.current).selectAll("circle").remove(),(0,r.Ys)(S.current).selectAll("circle").data(t).join((e=>e.append("circle").attr("cx",(([e=0])=>c(e))).attr("cy",(([,e=0])=>u(e))).attr("r",0).attr("fill",(([e=0])=>d(e))).on("mouseover",((e,[,,t])=>w.next({left:e.layerX,top:e.layerY,label:t}))).on("mouseout",((e,t)=>w.next(null))).call((e=>e.transition().duration(200).attr("r",2).style("opacity",1)))),(e=>e.attr("fill","lightgrey")),(e=>e.attr("fill","tomato").call((e=>e.transition().duration(200).attr("r",0).style("opacity",0).remove()))));const m=(0,r.LLu)(c).ticks(5).tickSizeOuter(0);(0,r.Ys)(k.current).call(m);const E=(0,r.y4O)(u).ticks(5).tickSizeOuter(0);(0,r.Ys)(_.current).call(E)}),[e,n,o]),a.createElement("div",{className:i()(m.Z.Chart)},a.createElement("fieldset",null,a.createElement("label",null,a.createElement("span",null,"x"),a.createElement("select",{value:n,onChange:e=>y((t=>({...t,xProp:e.target.value})))},Object.entries(E).map((([e,t])=>a.createElement("option",{key:e,value:e},t))))),a.createElement("label",null,a.createElement("span",null,"y"),a.createElement("select",{value:o,onChange:e=>y((t=>({...t,yProp:e.target.value})))},Object.entries(E).map((([e,t])=>a.createElement("option",{key:e,value:e},t)))))),a.createElement("svg",{ref:S,width:p,height:f,viewBox:`0, 0, ${p}, ${f}`},a.createElement("g",{transform:`translate(0, ${f-b})`,ref:k}),a.createElement("g",{transform:`translate(${h}, 0)`,ref:_})),t&&a.createElement("div",{className:m.Z.Tooltip,style:{top:t.top,left:t.left}},t.label))}var k=l(5062),_=l.n(k),S=l(9386),w=l(5449),x=l(1128),N=l(3964),C=l(2048),$=l(5176),T=l(7122),Z=l(9530),M=l(5096),P=l(7815);function U({position:e,children:t,setPosition:l}){const n=(0,a.useRef)(null),r=(0,a.useMemo)((()=>({dragend(){const e=n.current;null!=e&&l(e.getLatLng())}})),[]);return a.createElement(S.J,{draggable:!0,eventHandlers:r,position:e,ref:n},a.createElement(w.u,null,t))}function I(){const e=(0,x.Sx)(),t=(0,a.useCallback)((t=>{t.preventDefault(),e.locate({setView:!0})}),[e]);return a.createElement("div",{className:"leaflet-top leaflet-left",style:{top:80,fontSize:16}},a.createElement("div",{className:"leaflet-control-locate leaflet-bar leaflet-control"},a.createElement("a",{className:"leaflet-bar-part leaflet-bar-part-single",title:"Locate",href:"#",onClick:t},a.createElement(Z.G,{icon:M.KS0}))))}function Y(e){return(0,a.useMemo)((()=>_().featureGroup(e.map((({position:{lat:e,lng:t}})=>_().marker([e,t])))).getBounds()),[])}function j({bounds:e,center:t,setCenter:n,list:r,zoom:o=12}){(0,a.useEffect)((()=>{delete _().Icon.Default.prototype._getIconUrl,_().Icon.Default.mergeOptions({iconRetinaUrl:l(1963).Z,iconUrl:l(379).Z,shadowUrl:l(6179).Z})}),[]);const[s,c]=(0,a.useState)(null),u=(0,a.useMemo)((()=>a.createElement(N.h,{bounds:e,center:t,whenCreated:c,zoom:o,className:i()(P.Z.Map)},a.createElement(C.I,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),a.createElement(U,{position:t,setPosition:n},`${t.lat},${t.lng}`),r.map((({i:e,id:l,position:n,name:r,item:o})=>a.createElement($.c,{key:e,center:n,pathOptions:{color:"purple"}},a.createElement(T.G,{minWidth:90},a.createElement("section",null,a.createElement("header",null,`[${l}] ${r} (${t.distanceTo(n).toFixed(0)/1e3} km)`),a.createElement("table",null,a.createElement("tbody",null,o.petrol_list.map((({type:e,price:t},l)=>a.createElement("tr",{key:l},a.createElement("th",null,e),a.createElement("td",null,t))))))))))),a.createElement(I,null))),[r,t]);return a.createElement("div",{className:i()(P.Z.Layout)},u)}var H=l(4772),G=l(8723);const L=[1,3,5,10,20,50,100,500],O=[0,1,2,3,4,5,6,7,8,9,10],B={"":"",pb:"pb","pb+":"pb+",on:"on","on+":"on+",lpg:"lpg","lpg+":"lpg+"},A=(0,n.k)((async e=>{const t=await fetch(`api/stations/data.json?${e}`);return await t.json().then((({results:e})=>({results:e.map((e=>({...e.petrol_list.reduce(((e,{type:t,price:l})=>Object.assign(e,{[`_petrol_${t}`]:Number(l)||0})),{}),...e})))})))}));function R({version:e="v1"}){const{results:t}=A.read(e),[l,n]=(0,a.useState)(""),[r]=(0,H.Z)(l),o=(0,a.useCallback)((({target:e})=>n(e.value)),[]),[i,s]=(0,a.useState)(5),c=(0,a.useCallback)((({target:e})=>s(Number(e.value))),[]),[u,d]=(0,a.useState)((()=>Object.keys(B)[0])),m=(0,a.useCallback)((({target:e})=>d(e.value)),[]),[p,f]=(0,a.useState)(O[0]),[h,g]=(0,a.useState)(O[O.length-1]),v=(0,a.useCallback)((({target:e})=>g((t=>{const l=Number(e.value);return f(l),t<l?l:t}))),[]),b=(0,a.useCallback)((({target:e})=>f((t=>{const l=Number(e.value);return g(l),l>t?t:l}))),[]);console.log({results:t});const E=(0,a.useMemo)((()=>t.map(((e,t)=>{const{station_id:l,x:a,y:n,network_name:r}=e;return{i:t,id:l,position:{lat:a,lng:n},name:r,item:e}})).filter((({name:e,item:{petrol_list:t}})=>{return e.toLowerCase().match(r)&&(!u||(l=t.find((e=>e.type===u)),Boolean(l)&&p<=l.price&&l.price<=h));var l}))),[t,r,u,p,h]),k=Y([{position:{lat:52.232855,lng:20.921111}}]),[_,S]=(0,a.useState)((()=>k.getCenter())),w=(0,a.useMemo)((()=>E.filter((({position:e})=>_.distanceTo(e)<1e3*i))),[E,_,i]),x=Y(w||k);return a.createElement("div",null,a.createElement(j,{bounds:x,center:_,setCenter:S,list:w}),a.createElement(y,{list:E}),a.createElement("fieldset",null,a.createElement("div",null,a.createElement("label",null,a.createElement("span",null,"Search"),a.createElement("input",{type:"search",value:l,onChange:o})),a.createElement("label",null,a.createElement("span",null,"Radius"),a.createElement("input",{type:"range",list:"range-list",min:L[0],max:L[L.length-1],value:i,onChange:c}),a.createElement("datalist",{id:"range-list"},L.map((e=>a.createElement("option",{key:e,value:e,label:[1,25,100].includes(e)?`${e} km`:void 0})))),a.createElement("span",null,`max ${i} km`))),a.createElement("div",null,a.createElement("label",null,a.createElement("span",null,"Type"),a.createElement("select",{value:u,onChange:m},Object.entries(B).map((([e,t])=>a.createElement("option",{key:e,value:e},t)))))),a.createElement("div",null,a.createElement("label",null,a.createElement("span",null,"Price From"),a.createElement("input",{type:"range",list:"price-list",min:O[0],max:O[O.length-1],value:p,onChange:v}),a.createElement("datalist",{id:"price-list"},O.map((e=>a.createElement("option",{key:e,value:e,label:[0,1,2,3,4,5].includes(e)?`${e} pln/l`:void 0}))))),a.createElement("label",null,a.createElement("span",null,"Price To"),a.createElement("input",{type:"range",list:"price-list",min:O[0],max:O[O.length-1],value:h,onChange:b}),a.createElement("span",null,`${p}-${h} pln/l`)))))}function z(){return a.createElement("div",{className:G.Z.Section},a.createElement("h2",null,"Stations"),a.createElement(R,null))}},4772:(e,t,l)=>{l.d(t,{Z:()=>n});var a=l(2784);function n(e){const[t,l]=(0,a.useState)(e),n=(0,a.useRef)();return(0,a.useEffect)((()=>(clearTimeout(n.current),n.current=setTimeout((()=>l(e.toLowerCase())),400),()=>{clearTimeout(n.current)})),[e]),[t]}},8365:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});var a=l(9601),n=l.n(a),r=l(2609),o=l.n(r)()(n());o.push([e.id,".NjHXg9NGgpl1h6itsGUI{position:relative;border:2px solid red}.NjHXg9NGgpl1h6itsGUI svg{width:100%;height:50vh}.NjHXg9NGgpl1h6itsGUI .Qeuu3ubiYLZshSsQhUN6{position:absolute}.Qeuu3ubiYLZshSsQhUN6{background:#fff;border:1px solid #add8e6;color:orange;padding:.25em}",""]),o.locals={Chart:"NjHXg9NGgpl1h6itsGUI",Tooltip:"Qeuu3ubiYLZshSsQhUN6"};const i=o},4312:(e,t,l)=>{l.r(t),l.d(t,{default:()=>c});var a=l(9601),n=l.n(a),r=l(2609),o=l.n(r),i=l(9138),s=o()(n());s.i(i.Z),s.push([e.id,".cStyiPbxd0HI9tByMkkY{height:75vh;border:2px solid red}.cStyiPbxd0HI9tByMkkY header{font-weight:bold}",""]),s.locals={Map:"cStyiPbxd0HI9tByMkkY"};const c=s},7938:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});var a=l(9601),n=l.n(a),r=l(2609),o=l.n(r)()(n());o.push([e.id,".JTHop_UDHoyJmmN4pc6w{color:blue}",""]),o.locals={Section:"JTHop_UDHoyJmmN4pc6w"};const i=o},4437:(e,t,l)=>{l.d(t,{Z:()=>y});var a=l(6062),n=l.n(a),r=l(4036),o=l.n(r),i=l(6793),s=l.n(i),c=l(7892),u=l.n(c),d=l(1173),m=l.n(d),p=l(2464),f=l.n(p),h=l(8365),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=s().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=m();var v=n()(h.default,g);if(!h.default.locals||e.hot.invalidate){var b=!h.default.locals,E=b?h:h.default.locals;e.hot.accept(8365,(t=>{h=l(8365),function(e,t,l){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!l||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if(!(l&&"default"===a||e[a]))return!1;return!0}(E,b?h:h.default.locals,b)?(E=b?h:h.default.locals,v(h.default)):e.hot.invalidate()}))}e.hot.dispose((function(){v()}));const y=h.default&&h.default.locals?h.default.locals:void 0},7815:(e,t,l)=>{l.d(t,{Z:()=>y});var a=l(6062),n=l.n(a),r=l(4036),o=l.n(r),i=l(6793),s=l.n(i),c=l(7892),u=l.n(c),d=l(1173),m=l.n(d),p=l(2464),f=l.n(p),h=l(4312),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=s().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=m();var v=n()(h.default,g);if(!h.default.locals||e.hot.invalidate){var b=!h.default.locals,E=b?h:h.default.locals;e.hot.accept(4312,(t=>{h=l(4312),function(e,t,l){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!l||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if(!(l&&"default"===a||e[a]))return!1;return!0}(E,b?h:h.default.locals,b)?(E=b?h:h.default.locals,v(h.default)):e.hot.invalidate()}))}e.hot.dispose((function(){v()}));const y=h.default&&h.default.locals?h.default.locals:void 0},8723:(e,t,l)=>{l.d(t,{Z:()=>y});var a=l(6062),n=l.n(a),r=l(4036),o=l.n(r),i=l(6793),s=l.n(i),c=l(7892),u=l.n(c),d=l(1173),m=l.n(d),p=l(2464),f=l.n(p),h=l(7938),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=s().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=m();var v=n()(h.default,g);if(!h.default.locals||e.hot.invalidate){var b=!h.default.locals,E=b?h:h.default.locals;e.hot.accept(7938,(t=>{h=l(7938),function(e,t,l){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!l||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if(!(l&&"default"===a||e[a]))return!1;return!0}(E,b?h:h.default.locals,b)?(E=b?h:h.default.locals,v(h.default)):e.hot.invalidate()}))}e.hot.dispose((function(){v()}));const y=h.default&&h.default.locals?h.default.locals:void 0}}]);