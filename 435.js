"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[435],{8435:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var r=n(1283),a=n(7946),l=n(965),o=n(2451),u=n(7162),c=n.n(u),i=n(2784),s=n(357),f=n(369),p=n(9635),d=n(2779),m=n.n(d),v=n(1148),b=n(5120),h=n(2335),g=n(9468),y=n(4437);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=200,k={id:"id",station_id:"station_id",network_id:"network_id",_petrol_on:"_petrol_on",_petrol_pb:"_petrol_pb",_distance:"_distance",_created:"_created",_updated:"_updated"};function _(e){var t=e.list,n=(0,i.useState)(null),r=(0,a.Z)(n,2),l=r[0],o=r[1],u=(0,i.useState)((function(){return{xProp:"network_id",yProp:"_petrol_pb"}})),c=(0,a.Z)(u,2),s=c[0],d=s.xProp,E=s.yProp,_=c[1],w=(0,i.useRef)(null),j=(0,i.useRef)(null),P=(0,i.useRef)(null),S=(0,i.useMemo)((function(){return new v.x}),[]);return(0,i.useEffect)((function(){var e=S.pipe((0,h.w)((function(e){return(0,b.of)(e).pipe((0,g.g)(e?0:800))}))).subscribe((function(e){return o(e)}));return function(){return e.unsubscribe()}}),[S]),(0,i.useEffect)((function(){var e=t.filter((function(e){var t=e.item;return t[d]&&t[E]})).slice(0,2e3).map((function(e){var t=e.item;return[t[d],t[E],"[".concat(t.id,"] ").concat(t.network_name," (").concat(t[d]," / ").concat(t[E],")")]})),n=e.map((function(e){var t=(0,a.Z)(e,1)[0];return void 0===t?0:t})),r=e.map((function(e){var t=(0,a.Z)(e,2)[1];return void 0===t?0:t})),l=[Math.min.apply(Math,(0,f.Z)(n)),Math.max.apply(Math,(0,f.Z)(n))],o=[Math.min.apply(Math,(0,f.Z)(r)),Math.max.apply(Math,(0,f.Z)(r))],u=(0,p.BYU)().domain(l).range([10,310]),c=(0,p.BYU)().domain(o).range([180,20]),i=(0,p.BYU)().domain(l).range(["red","blue"]);(0,p.Ys)(P.current).selectAll("circle").remove(),(0,p.Ys)(P.current).selectAll("circle").data(e).join((function(e){return e.append("circle").attr("cx",(function(e){var t=(0,a.Z)(e,1)[0];return u(void 0===t?0:t)})).attr("cy",(function(e){var t=(0,a.Z)(e,2)[1];return c(void 0===t?0:t)})).attr("r",0).attr("fill",(function(e){var t=(0,a.Z)(e,1)[0];return i(void 0===t?0:t)})).on("mouseover",(function(e,t){var n=(0,a.Z)(t,3)[2];return S.next({left:e.layerX,top:e.layerY,label:n})})).on("mouseout",(function(e,t){return S.next(null)})).call((function(e){return e.transition().duration(200).attr("r",2).style("opacity",1)}))}),(function(e){return e.attr("fill","lightgrey")}),(function(e){return e.attr("fill","tomato").call((function(e){return e.transition().duration(200).attr("r",0).style("opacity",0).remove()}))}));var s=(0,p.LLu)(u).ticks(5).tickSizeOuter(0);(0,p.Ys)(w.current).call(s);var m=(0,p.y4O)(c).ticks(5).tickSizeOuter(0);(0,p.Ys)(j.current).call(m)}),[t,d,E]),i.createElement("div",{className:m()(y.Z.Chart)},i.createElement("fieldset",null,i.createElement("label",null,i.createElement("span",null,"x"),i.createElement("select",{value:d,onChange:function(e){return _((function(t){return O(O({},t),{},{xProp:e.target.value})}))}},Object.entries(k).map((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];return i.createElement("option",{key:n,value:n},r)})))),i.createElement("label",null,i.createElement("span",null,"y"),i.createElement("select",{value:E,onChange:function(e){return _((function(t){return O(O({},t),{},{yProp:e.target.value})}))}},Object.entries(k).map((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];return i.createElement("option",{key:n,value:n},r)}))))),i.createElement("svg",{ref:P,width:320,height:Z,viewBox:"0, 0, ".concat(320,", ").concat(Z)},i.createElement("g",{transform:"translate(0, ".concat(180,")"),ref:w}),i.createElement("g",{transform:"translate(".concat(10,", 0)"),ref:j})),l&&i.createElement("div",{className:y.Z.Tooltip,style:{top:l.top,left:l.left}},l.label))}var w=n(5062),j=n.n(w),P=n(809),S=n(7234),x=n(5804),N=n(493),C=n(8969),M=n(9982),T=n(6127),U=n(9530),I=n(5096),Y=n(7815);function D(e){var t=e.position,n=e.children,r=e.setPosition,a=(0,i.useRef)(null),l=(0,i.useMemo)((function(){return{dragend:function(){var e=a.current;null!=e&&r(e.getLatLng())}}}),[]);return i.createElement(P.J,{draggable:!0,eventHandlers:l,position:t,ref:a},i.createElement(S.u,null,n))}function H(){var e=(0,x.Sx)(),t=(0,i.useCallback)((function(t){t.preventDefault(),e.locate({setView:!0})}),[e]);return i.createElement("div",{className:"leaflet-top leaflet-left",style:{top:80,fontSize:16}},i.createElement("div",{className:"leaflet-control-locate leaflet-bar leaflet-control"},i.createElement("a",{className:"leaflet-bar-part leaflet-bar-part-single",title:"Locate",href:"#",onClick:t},i.createElement(U.G,{icon:I.KS0}))))}function L(e){return(0,i.useMemo)((function(){return j().featureGroup(e.map((function(e){var t=e.position,n=t.lat,r=t.lng;return j().marker([n,r])}))).getBounds()}),[])}function G(e){var t=e.bounds,r=e.center,a=e.setCenter,l=e.list,o=e.zoom,u=void 0===o?12:o;(0,i.useEffect)((function(){delete j().Icon.Default.prototype._getIconUrl,j().Icon.Default.mergeOptions({iconRetinaUrl:n(1963).Z,iconUrl:n(379).Z,shadowUrl:n(6179).Z})}),[]);var c=(0,i.useMemo)((function(){return i.createElement(N.h,{bounds:t,center:r,zoom:u,className:m()(Y.Z.Map)},i.createElement(C.I,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),i.createElement(D,{position:r,setPosition:a},"".concat(r.lat,",").concat(r.lng)),l.map((function(e){var t=e.i,n=e.id,a=e.position,l=e.name,o=e.item;return i.createElement(M.c,{key:t,center:a,pathOptions:{color:"purple"}},i.createElement(T.G,{minWidth:90},i.createElement("section",null,i.createElement("header",null,"[".concat(n,"] ").concat([l].concat(o.address||[]).join(" - ")," (").concat(r.distanceTo(a).toFixed(0)/1e3," km)")),i.createElement("table",null,i.createElement("tbody",null,o.petrol_list.map((function(e,t){var n=e.type,r=e.price;return i.createElement("tr",{key:t},i.createElement("th",null,n),i.createElement("td",null,r))})))))))})),i.createElement(H,null))}),[l,r]);return i.createElement("div",{className:m()(Y.Z.Layout)},c)}var B=n(4772),A=n(8723),R=["position","item"];function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=[1,3,5,10,20,50,100,500],X=[0,1,2,3,4,5,6,7,8,9,10],F={"":"",pb:"pb","pb+":"pb+",on:"on","on+":"on+",lpg:"lpg","lpg+":"lpg+"},K=(0,s.k)(function(){var e=(0,o.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("api/stations/data.json?".concat(t));case 2:return n=e.sent,e.next=5,n.json().then((function(e){return{results:e.results.map((function(e){return Q(Q({},e.petrol_list.reduce((function(e,t){var n=t.type,r=t.price;return Object.assign(e,(0,l.Z)({},"_petrol_".concat(n),Number(r)||0))}),{})),e)}))}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());function V(e){var t=e.version,n=void 0===t?"v1":t,l=K.read(n).results,o=(0,i.useState)(""),u=(0,a.Z)(o,2),c=u[0],s=u[1],f=(0,B.Z)(c),p=(0,a.Z)(f,1)[0],d=(0,i.useCallback)((function(e){var t=e.target;return s(t.value)}),[]),m=(0,i.useState)(5),v=(0,a.Z)(m,2),b=v[0],h=v[1],g=(0,i.useCallback)((function(e){var t=e.target;return h(Number(t.value))}),[]),y=(0,i.useState)((function(){return Object.keys(F)[0]})),E=(0,a.Z)(y,2),O=E[0],Z=E[1],k=(0,i.useCallback)((function(e){var t=e.target;return Z(t.value)}),[]),w=(0,i.useState)(X[0]),j=(0,a.Z)(w,2),P=j[0],S=j[1],x=(0,i.useState)(X[X.length-1]),N=(0,a.Z)(x,2),C=N[0],M=N[1],T=(0,i.useCallback)((function(e){var t=e.target;return M((function(e){var n=Number(t.value);return S(n),e<n?n:e}))}),[]),U=(0,i.useCallback)((function(e){var t=e.target;return S((function(e){var n=Number(t.value);return M(n),n>e?e:n}))}),[]);console.log({results:l});var I=(0,i.useMemo)((function(){return l.map((function(e,t){return{i:t,id:e.station_id,position:{lat:e.x,lng:e.y},name:e.network_name,item:e}})).filter((function(e){var t,n=e.name,r=e.item,a=r.petrol_list,l=r.address,o=void 0===l?"":l;return(n.toLowerCase().match(p)||o.toLowerCase().match(p))&&(!O||(t=a.find((function(e){return e.type===O})),Boolean(t)&&P<=t.price&&t.price<=C))}))}),[l,p,O,P,C]),Y=L([{position:{lat:52.232855,lng:20.921111}}]),D=(0,i.useState)((function(){return Y.getCenter()})),H=(0,a.Z)(D,2),A=H[0],z=H[1],V=(0,i.useMemo)((function(){return I.map((function(e){var t=e.position,n=e.item,a=(0,r.Z)(e,R);return Q({position:t,item:Q(Q({},n),{},{_distance:A.distanceTo(t)})},a)})).filter((function(e){return e.item._distance<1e3*b}))}),[I,A,b]),W=L(V);return i.createElement("div",null,i.createElement(G,{bounds:W,center:A,setCenter:z,list:V}),i.createElement(_,{list:V}),i.createElement("fieldset",null,i.createElement("div",null,i.createElement("label",null,i.createElement("span",null,"Search"),i.createElement("input",{type:"search",value:c,onChange:d})),i.createElement("label",null,i.createElement("span",null,"Radius"),i.createElement("input",{type:"range",list:"range-list",min:J[0],max:J[J.length-1],value:b,onChange:g}),i.createElement("datalist",{id:"range-list"},J.map((function(e){return i.createElement("option",{key:e,value:e,label:[1,25,100].includes(e)?"".concat(e," km"):void 0})}))),i.createElement("span",null,"max ".concat(b," km")))),i.createElement("div",null,i.createElement("label",null,i.createElement("span",null,"Type"),i.createElement("select",{value:O,onChange:k},Object.entries(F).map((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];return i.createElement("option",{key:n,value:n},r)}))))),i.createElement("div",null,i.createElement("label",null,i.createElement("span",null,"Price From"),i.createElement("input",{type:"range",list:"price-list",min:X[0],max:X[X.length-1],value:P,onChange:T}),i.createElement("datalist",{id:"price-list"},X.map((function(e){return i.createElement("option",{key:e,value:e,label:[0,1,2,3,4,5].includes(e)?"".concat(e," pln/l"):void 0})})))),i.createElement("label",null,i.createElement("span",null,"Price To"),i.createElement("input",{type:"range",list:"price-list",min:X[0],max:X[X.length-1],value:C,onChange:U}),i.createElement("span",null,"".concat(P,"-").concat(C," pln/l"))))))}function W(){return i.createElement("div",{className:A.Z.Section},i.createElement("h2",null,"Stations"),i.createElement(V,null))}},4772:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(7946),a=n(2784);function l(e){var t=(0,a.useState)(e),n=(0,r.Z)(t,2),l=n[0],o=n[1],u=(0,a.useRef)();return(0,a.useEffect)((function(){return clearTimeout(u.current),u.current=setTimeout((function(){return o(e.toLowerCase())}),400),function(){clearTimeout(u.current)}}),[e]),[l]}},8365:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(9601),a=n.n(r),l=n(2609),o=n.n(l)()(a());o.push([e.id,".NjHXg9NGgpl1h6itsGUI{position:relative;border:2px solid red}.NjHXg9NGgpl1h6itsGUI svg{width:100%;height:50vh}.NjHXg9NGgpl1h6itsGUI .Qeuu3ubiYLZshSsQhUN6{position:absolute}.Qeuu3ubiYLZshSsQhUN6{background:#fff;border:1px solid #add8e6;color:orange;padding:.25em}",""]),o.locals={Chart:"NjHXg9NGgpl1h6itsGUI",Tooltip:"Qeuu3ubiYLZshSsQhUN6"};const u=o},4312:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(9601),a=n.n(r),l=n(2609),o=n.n(l),u=n(9138),c=o()(a());c.i(u.Z),c.push([e.id,".cStyiPbxd0HI9tByMkkY{height:75vh;border:2px solid red}.cStyiPbxd0HI9tByMkkY header{font-weight:bold}",""]),c.locals={Map:"cStyiPbxd0HI9tByMkkY"};const i=c},7938:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(9601),a=n.n(r),l=n(2609),o=n.n(l)()(a());o.push([e.id,".JTHop_UDHoyJmmN4pc6w{color:blue}",""]),o.locals={Section:"JTHop_UDHoyJmmN4pc6w"};const u=o},4437:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(6062),a=n.n(r),l=n(4036),o=n.n(l),u=n(6793),c=n.n(u),i=n(7892),s=n.n(i),f=n(1173),p=n.n(f),d=n(2464),m=n.n(d),v=n(8365),b={};b.styleTagTransform=m(),b.setAttributes=s(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=p();var h=a()(v.default,b);if(!v.default.locals||e.hot.invalidate){var g=!v.default.locals,y=g?v:v.default.locals;e.hot.accept(8365,(t=>{v=n(8365),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(y,g?v:v.default.locals,g)?(y=g?v:v.default.locals,h(v.default)):e.hot.invalidate()}))}e.hot.dispose((function(){h()}));const E=v.default&&v.default.locals?v.default.locals:void 0},7815:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(6062),a=n.n(r),l=n(4036),o=n.n(l),u=n(6793),c=n.n(u),i=n(7892),s=n.n(i),f=n(1173),p=n.n(f),d=n(2464),m=n.n(d),v=n(4312),b={};b.styleTagTransform=m(),b.setAttributes=s(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=p();var h=a()(v.default,b);if(!v.default.locals||e.hot.invalidate){var g=!v.default.locals,y=g?v:v.default.locals;e.hot.accept(4312,(t=>{v=n(4312),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(y,g?v:v.default.locals,g)?(y=g?v:v.default.locals,h(v.default)):e.hot.invalidate()}))}e.hot.dispose((function(){h()}));const E=v.default&&v.default.locals?v.default.locals:void 0},8723:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(6062),a=n.n(r),l=n(4036),o=n.n(l),u=n(6793),c=n.n(u),i=n(7892),s=n.n(i),f=n(1173),p=n.n(f),d=n(2464),m=n.n(d),v=n(7938),b={};b.styleTagTransform=m(),b.setAttributes=s(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=p();var h=a()(v.default,b);if(!v.default.locals||e.hot.invalidate){var g=!v.default.locals,y=g?v:v.default.locals;e.hot.accept(7938,(t=>{v=n(7938),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(y,g?v:v.default.locals,g)?(y=g?v:v.default.locals,h(v.default)):e.hot.invalidate()}))}e.hot.dispose((function(){h()}));const E=v.default&&v.default.locals?v.default.locals:void 0}}]);