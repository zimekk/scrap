"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[435],{8435:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var r=n(7946),a=n(965),l=n(2451),o=n(7162),u=n.n(o),c=n(2784),i=n(357),s=n(369),f=n(9635),p=n(2779),d=n.n(p),m=n(1148),v=n(5120),b=n(2335),h=n(6982),g=n(4437);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=200,Z={id:"id",station_id:"station_id",network_id:"network_id",_petrol_on:"_petrol_on",_petrol_pb:"_petrol_pb",_created:"_created",_updated:"_updated"};function k(e){var t=e.list,n=(0,c.useState)(null),a=(0,r.Z)(n,2),l=a[0],o=a[1],u=(0,c.useState)((function(){return{xProp:"network_id",yProp:"_petrol_pb"}})),i=(0,r.Z)(u,2),p=i[0],y=p.xProp,k=p.yProp,w=i[1],j=(0,c.useRef)(null),_=(0,c.useRef)(null),P=(0,c.useRef)(null),S=(0,c.useMemo)((function(){return new m.x}),[]);return(0,c.useEffect)((function(){var e=S.pipe((0,b.w)((function(e){return(0,v.of)(e).pipe((0,h.g)(e?0:800))}))).subscribe((function(e){return o(e)}));return function(){return e.unsubscribe()}}),[S]),(0,c.useEffect)((function(){var e=t.filter((function(e){var t=e.item;return t[y]&&t[k]})).slice(0,2e3).map((function(e){var t=e.item;return[t[y],t[k],"[".concat(t.id,"] ").concat(t.network_name," (").concat(t[y]," / ").concat(t[k],")")]})),n=e.map((function(e){var t=(0,r.Z)(e,1)[0];return void 0===t?0:t})),a=e.map((function(e){var t=(0,r.Z)(e,2)[1];return void 0===t?0:t})),l=[Math.min.apply(Math,(0,s.Z)(n)),Math.max.apply(Math,(0,s.Z)(n))],o=[Math.min.apply(Math,(0,s.Z)(a)),Math.max.apply(Math,(0,s.Z)(a))],u=(0,f.BYU)().domain(l).range([10,310]),c=(0,f.BYU)().domain(o).range([180,20]),i=(0,f.BYU)().domain(l).range(["red","blue"]);(0,f.Ys)(P.current).selectAll("circle").remove(),(0,f.Ys)(P.current).selectAll("circle").data(e).join((function(e){return e.append("circle").attr("cx",(function(e){var t=(0,r.Z)(e,1)[0];return u(void 0===t?0:t)})).attr("cy",(function(e){var t=(0,r.Z)(e,2)[1];return c(void 0===t?0:t)})).attr("r",0).attr("fill",(function(e){var t=(0,r.Z)(e,1)[0];return i(void 0===t?0:t)})).on("mouseover",(function(e,t){var n=(0,r.Z)(t,3)[2];return S.next({left:e.layerX,top:e.layerY,label:n})})).on("mouseout",(function(e,t){return S.next(null)})).call((function(e){return e.transition().duration(200).attr("r",2).style("opacity",1)}))}),(function(e){return e.attr("fill","lightgrey")}),(function(e){return e.attr("fill","tomato").call((function(e){return e.transition().duration(200).attr("r",0).style("opacity",0).remove()}))}));var p=(0,f.LLu)(u).ticks(5).tickSizeOuter(0);(0,f.Ys)(j.current).call(p);var d=(0,f.y4O)(c).ticks(5).tickSizeOuter(0);(0,f.Ys)(_.current).call(d)}),[t,y,k]),c.createElement("div",{className:d()(g.Z.Chart)},c.createElement("fieldset",null,c.createElement("label",null,c.createElement("span",null,"x"),c.createElement("select",{value:y,onChange:function(e){return w((function(t){return E(E({},t),{},{xProp:e.target.value})}))}},Object.entries(Z).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return c.createElement("option",{key:n,value:n},a)})))),c.createElement("label",null,c.createElement("span",null,"y"),c.createElement("select",{value:k,onChange:function(e){return w((function(t){return E(E({},t),{},{yProp:e.target.value})}))}},Object.entries(Z).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return c.createElement("option",{key:n,value:n},a)}))))),c.createElement("svg",{ref:P,width:320,height:O,viewBox:"0, 0, ".concat(320,", ").concat(O)},c.createElement("g",{transform:"translate(0, ".concat(180,")"),ref:j}),c.createElement("g",{transform:"translate(".concat(10,", 0)"),ref:_})),l&&c.createElement("div",{className:g.Z.Tooltip,style:{top:l.top,left:l.left}},l.label))}var w=n(5062),j=n.n(w),_=n(809),P=n(7234),S=n(5804),x=n(493),N=n(8969),C=n(9982),M=n(6127),T=n(9530),U=n(5096),I=n(7815);function Y(e){var t=e.position,n=e.children,r=e.setPosition,a=(0,c.useRef)(null),l=(0,c.useMemo)((function(){return{dragend:function(){var e=a.current;null!=e&&r(e.getLatLng())}}}),[]);return c.createElement(_.J,{draggable:!0,eventHandlers:l,position:t,ref:a},c.createElement(P.u,null,n))}function D(){var e=(0,S.Sx)(),t=(0,c.useCallback)((function(t){t.preventDefault(),e.locate({setView:!0})}),[e]);return c.createElement("div",{className:"leaflet-top leaflet-left",style:{top:80,fontSize:16}},c.createElement("div",{className:"leaflet-control-locate leaflet-bar leaflet-control"},c.createElement("a",{className:"leaflet-bar-part leaflet-bar-part-single",title:"Locate",href:"#",onClick:t},c.createElement(T.G,{icon:U.KS0}))))}function H(e){return(0,c.useMemo)((function(){return j().featureGroup(e.map((function(e){var t=e.position,n=t.lat,r=t.lng;return j().marker([n,r])}))).getBounds()}),[])}function G(e){var t=e.bounds,r=e.center,a=e.setCenter,l=e.list,o=e.zoom,u=void 0===o?12:o;(0,c.useEffect)((function(){delete j().Icon.Default.prototype._getIconUrl,j().Icon.Default.mergeOptions({iconRetinaUrl:n(1963).Z,iconUrl:n(379).Z,shadowUrl:n(6179).Z})}),[]);var i=(0,c.useMemo)((function(){return c.createElement(x.h,{bounds:t,center:r,zoom:u,className:d()(I.Z.Map)},c.createElement(N.I,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),c.createElement(Y,{position:r,setPosition:a},"".concat(r.lat,",").concat(r.lng)),l.map((function(e){var t=e.i,n=e.id,a=e.position,l=e.name,o=e.item;return c.createElement(C.c,{key:t,center:a,pathOptions:{color:"purple"}},c.createElement(M.G,{minWidth:90},c.createElement("section",null,c.createElement("header",null,"[".concat(n,"] ").concat(l," (").concat(r.distanceTo(a).toFixed(0)/1e3," km)")),c.createElement("table",null,c.createElement("tbody",null,o.petrol_list.map((function(e,t){var n=e.type,r=e.price;return c.createElement("tr",{key:t},c.createElement("th",null,n),c.createElement("td",null,r))})))))))})),c.createElement(D,null))}),[l,r]);return c.createElement("div",{className:d()(I.Z.Layout)},i)}var L=n(4772),B=n(8723);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=[1,3,5,10,20,50,100,500],Q=[0,1,2,3,4,5,6,7,8,9,10],J={"":"",pb:"pb","pb+":"pb+",on:"on","on+":"on+",lpg:"lpg","lpg+":"lpg+"},X=(0,i.k)(function(){var e=(0,l.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("api/stations/data.json?".concat(t));case 2:return n=e.sent,e.next=5,n.json().then((function(e){return{results:e.results.map((function(e){return R(R({},e.petrol_list.reduce((function(e,t){var n=t.type,r=t.price;return Object.assign(e,(0,a.Z)({},"_petrol_".concat(n),Number(r)||0))}),{})),e)}))}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());function F(e){var t=e.version,n=void 0===t?"v1":t,a=X.read(n).results,l=(0,c.useState)(""),o=(0,r.Z)(l,2),u=o[0],i=o[1],s=(0,L.Z)(u),f=(0,r.Z)(s,1)[0],p=(0,c.useCallback)((function(e){var t=e.target;return i(t.value)}),[]),d=(0,c.useState)(5),m=(0,r.Z)(d,2),v=m[0],b=m[1],h=(0,c.useCallback)((function(e){var t=e.target;return b(Number(t.value))}),[]),g=(0,c.useState)((function(){return Object.keys(J)[0]})),y=(0,r.Z)(g,2),E=y[0],O=y[1],Z=(0,c.useCallback)((function(e){var t=e.target;return O(t.value)}),[]),w=(0,c.useState)(Q[0]),j=(0,r.Z)(w,2),_=j[0],P=j[1],S=(0,c.useState)(Q[Q.length-1]),x=(0,r.Z)(S,2),N=x[0],C=x[1],M=(0,c.useCallback)((function(e){var t=e.target;return C((function(e){var n=Number(t.value);return P(n),e<n?n:e}))}),[]),T=(0,c.useCallback)((function(e){var t=e.target;return P((function(e){var n=Number(t.value);return C(n),n>e?e:n}))}),[]);console.log({results:a});var U=(0,c.useMemo)((function(){return a.map((function(e,t){return{i:t,id:e.station_id,position:{lat:e.x,lng:e.y},name:e.network_name,item:e}})).filter((function(e){var t,n=e.name,r=e.item.petrol_list;return n.toLowerCase().match(f)&&(!E||(t=r.find((function(e){return e.type===E})),Boolean(t)&&_<=t.price&&t.price<=N))}))}),[a,f,E,_,N]),I=H([{position:{lat:52.232855,lng:20.921111}}]),Y=(0,c.useState)((function(){return I.getCenter()})),D=(0,r.Z)(Y,2),B=D[0],A=D[1],R=(0,c.useMemo)((function(){return U.filter((function(e){var t=e.position;return B.distanceTo(t)<1e3*v}))}),[U,B,v]),F=H(R);return c.createElement("div",null,c.createElement(G,{bounds:F,center:B,setCenter:A,list:R}),c.createElement(k,{list:R}),c.createElement("fieldset",null,c.createElement("div",null,c.createElement("label",null,c.createElement("span",null,"Search"),c.createElement("input",{type:"search",value:u,onChange:p})),c.createElement("label",null,c.createElement("span",null,"Radius"),c.createElement("input",{type:"range",list:"range-list",min:z[0],max:z[z.length-1],value:v,onChange:h}),c.createElement("datalist",{id:"range-list"},z.map((function(e){return c.createElement("option",{key:e,value:e,label:[1,25,100].includes(e)?"".concat(e," km"):void 0})}))),c.createElement("span",null,"max ".concat(v," km")))),c.createElement("div",null,c.createElement("label",null,c.createElement("span",null,"Type"),c.createElement("select",{value:E,onChange:Z},Object.entries(J).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return c.createElement("option",{key:n,value:n},a)}))))),c.createElement("div",null,c.createElement("label",null,c.createElement("span",null,"Price From"),c.createElement("input",{type:"range",list:"price-list",min:Q[0],max:Q[Q.length-1],value:_,onChange:M}),c.createElement("datalist",{id:"price-list"},Q.map((function(e){return c.createElement("option",{key:e,value:e,label:[0,1,2,3,4,5].includes(e)?"".concat(e," pln/l"):void 0})})))),c.createElement("label",null,c.createElement("span",null,"Price To"),c.createElement("input",{type:"range",list:"price-list",min:Q[0],max:Q[Q.length-1],value:N,onChange:T}),c.createElement("span",null,"".concat(_,"-").concat(N," pln/l"))))))}function K(){return c.createElement("div",{className:B.Z.Section},c.createElement("h2",null,"Stations"),c.createElement(F,null))}},4772:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(7946),a=n(2784);function l(e){var t=(0,a.useState)(e),n=(0,r.Z)(t,2),l=n[0],o=n[1],u=(0,a.useRef)();return(0,a.useEffect)((function(){return clearTimeout(u.current),u.current=setTimeout((function(){return o(e.toLowerCase())}),400),function(){clearTimeout(u.current)}}),[e]),[l]}},8365:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(9601),a=n.n(r),l=n(2609),o=n.n(l)()(a());o.push([e.id,".NjHXg9NGgpl1h6itsGUI{position:relative;border:2px solid red}.NjHXg9NGgpl1h6itsGUI svg{width:100%;height:50vh}.NjHXg9NGgpl1h6itsGUI .Qeuu3ubiYLZshSsQhUN6{position:absolute}.Qeuu3ubiYLZshSsQhUN6{background:#fff;border:1px solid #add8e6;color:orange;padding:.25em}",""]),o.locals={Chart:"NjHXg9NGgpl1h6itsGUI",Tooltip:"Qeuu3ubiYLZshSsQhUN6"};const u=o},4312:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(9601),a=n.n(r),l=n(2609),o=n.n(l),u=n(9138),c=o()(a());c.i(u.Z),c.push([e.id,".cStyiPbxd0HI9tByMkkY{height:75vh;border:2px solid red}.cStyiPbxd0HI9tByMkkY header{font-weight:bold}",""]),c.locals={Map:"cStyiPbxd0HI9tByMkkY"};const i=c},7938:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(9601),a=n.n(r),l=n(2609),o=n.n(l)()(a());o.push([e.id,".JTHop_UDHoyJmmN4pc6w{color:blue}",""]),o.locals={Section:"JTHop_UDHoyJmmN4pc6w"};const u=o},4437:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(6062),a=n.n(r),l=n(4036),o=n.n(l),u=n(6793),c=n.n(u),i=n(7892),s=n.n(i),f=n(1173),p=n.n(f),d=n(2464),m=n.n(d),v=n(8365),b={};b.styleTagTransform=m(),b.setAttributes=s(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=p();var h=a()(v.default,b);if(!v.default.locals||e.hot.invalidate){var g=!v.default.locals,y=g?v:v.default.locals;e.hot.accept(8365,(t=>{v=n(8365),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(y,g?v:v.default.locals,g)?(y=g?v:v.default.locals,h(v.default)):e.hot.invalidate()}))}e.hot.dispose((function(){h()}));const E=v.default&&v.default.locals?v.default.locals:void 0},7815:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(6062),a=n.n(r),l=n(4036),o=n.n(l),u=n(6793),c=n.n(u),i=n(7892),s=n.n(i),f=n(1173),p=n.n(f),d=n(2464),m=n.n(d),v=n(4312),b={};b.styleTagTransform=m(),b.setAttributes=s(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=p();var h=a()(v.default,b);if(!v.default.locals||e.hot.invalidate){var g=!v.default.locals,y=g?v:v.default.locals;e.hot.accept(4312,(t=>{v=n(4312),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(y,g?v:v.default.locals,g)?(y=g?v:v.default.locals,h(v.default)):e.hot.invalidate()}))}e.hot.dispose((function(){h()}));const E=v.default&&v.default.locals?v.default.locals:void 0},8723:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(6062),a=n.n(r),l=n(4036),o=n.n(l),u=n(6793),c=n.n(u),i=n(7892),s=n.n(i),f=n(1173),p=n.n(f),d=n(2464),m=n.n(d),v=n(7938),b={};b.styleTagTransform=m(),b.setAttributes=s(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=p();var h=a()(v.default,b);if(!v.default.locals||e.hot.invalidate){var g=!v.default.locals,y=g?v:v.default.locals;e.hot.accept(7938,(t=>{v=n(7938),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(y,g?v:v.default.locals,g)?(y=g?v:v.default.locals,h(v.default)):e.hot.invalidate()}))}e.hot.dispose((function(){h()}));const E=v.default&&v.default.locals?v.default.locals:void 0}}]);