{"version":3,"file":"46.js","mappings":"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","sources":["webpack://@dev/web/./src/containers/Products/styles.module.scss?9960","webpack://@dev/web/./src/containers/Products/index.tsx","webpack://@dev/web/./src/containers/useDebounce.ts","webpack://@dev/web/./src/containers/Products/styles.module.scss","webpack://@dev/web/../../node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"],"sourcesContent":["\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, {\n  ChangeEventHandler,\n  useCallback,\n  useMemo,\n  useState,\n} from \"react\";\nimport { format } from \"date-fns\";\nimport { createAsset } from \"use-asset\";\nimport { Gallery } from \"../../components/Gallery\";\nimport { Link } from \"../../components/Link\";\nimport useDebounce from \"../useDebounce\";\nimport cx from \"classnames\";\nimport styles from \"./styles.module.scss\";\n\nimport type {\n  ProductItem,\n  ReviewItem,\n} from \"@dev/cli/src/services/ProductService/types\";\n\nconst SORT_BY = {\n  title: 1,\n  brand: 1,\n  _price: 1,\n  _stars: -1,\n  _created: -1,\n  _updated: -1,\n};\n\nconst PRICE_LIST = [\n  0, 100, 200, 500, 1000, 1500, 2000, 3000, 4000, 5000, 10000, 15000, 20000,\n  25000,\n];\n\n// https://github.com/pmndrs/use-asset#dealing-with-async-assets\nconst asset = createAsset(async (version) => {\n  // copy({results:temp1.results.filter(item=>[460088,682156,681208].includes(Number(item.id))).map(({_id,_history,...item }) => item)})\n  const res = await fetch(`api/products/data.json?${version}`);\n  return await res.json();\n});\n\nexport const getPrice = (price: string[]) =>\n  Number(\n    (price.length > 0 ? price : [\"0\"])\n      .reverse()[0]\n      .replace(/[^0-9,\\.]/g, \"\")\n      .replace(\",\", \".\")\n  );\n\nexport const getMinMaxPrices = ({ price, _history = {} }: any) =>\n  Object.entries<any>({\n    [Date.now()]: { price },\n    ..._history,\n  }).reduce(\n    (result, [_date, { price }]) =>\n      ((price) =>\n        Object.assign(\n          result,\n          0 < price && price < result.priceMin ? { priceMin: price } : {},\n          price > result.priceMax ? { priceMax: price } : {}\n        ))(getPrice(price)),\n    ((price) => ({\n      priceNow: price,\n      priceMin: price,\n      priceMax: price,\n    }))(getPrice(price))\n  );\n\nconst formatPrice = (price: number) =>\n  `${new Intl.NumberFormat(\"pl-PL\", {\n    minimumFractionDigits: 2,\n  }).format(price)} PLN`;\n\nconst priceChange = (price: number, after: number) =>\n  `${new Intl.NumberFormat(\"pl-PL\", {\n    maximumFractionDigits: 2,\n  }).format(100 * (price / after - 1))}%`;\n\nfunction Compare({ item }: { item: ReturnType<typeof getMinMaxPrices> }) {\n  return (\n    <div>\n      <span>\n        <b>{` cena: ${formatPrice(item.priceNow)} `}</b>\n      </span>\n      {item.priceMin < item.priceNow && (\n        <span>\n          {` / min: ${formatPrice(item.priceMin)} (${priceChange(\n            item.priceNow,\n            item.priceMin\n          )}) `}\n        </span>\n      )}\n      {item.priceNow < item.priceMax && (\n        <span>\n          {` / max: ${formatPrice(item.priceMax)} (${priceChange(\n            item.priceNow,\n            item.priceMax\n          )}) `}\n        </span>\n      )}\n      <pre>\n        {JSON.stringify(\n          {\n            priceNow: item.priceNow,\n            priceMin: item.priceMin,\n            priceMax: item.priceMax,\n          },\n          null,\n          2\n        )}\n      </pre>\n    </div>\n  );\n}\n\nfunction Data({ version = \"v1\" }) {\n  const { results } = asset.read(version) as { results: ProductItem[] };\n\n  const options = useMemo(\n    () => ({\n      brand: [\"\"].concat(\n        results\n          .map(({ brand }: any) => brand)\n          .filter(Boolean)\n          .filter(\n            (value: any, index: number, array: any[]) =>\n              array.indexOf(value) === index\n          )\n          .sort((a: string, b: string) => a.localeCompare(b))\n      ),\n    }),\n    [results]\n  );\n\n  const [filters, setFilters] = useState(() => ({\n    brand: options.brand[0],\n    category: \"\",\n    search: \"\",\n    onlyPromoted: false,\n    onlyReduced: false,\n    priceFrom: PRICE_LIST[0],\n    priceTo: PRICE_LIST[PRICE_LIST.length - 1],\n  }));\n\n  const [filter] = useDebounce(filters.search);\n\n  const [sortBy, setSortBy] = useState(\n    () => Object.keys(SORT_BY).pop() as keyof typeof SORT_BY\n  );\n\n  const onChangePriceFrom = useCallback<ChangeEventHandler<HTMLInputElement>>(\n    ({ target }) =>\n      setFilters(({ priceTo, ...criteria }) => {\n        const priceFrom = Number(target.value);\n        return {\n          ...criteria,\n          priceFrom,\n          priceTo: priceTo < priceFrom ? priceFrom : priceTo,\n        };\n      }),\n    []\n  );\n\n  const onChangePriceTo = useCallback<ChangeEventHandler<HTMLInputElement>>(\n    ({ target }) =>\n      setFilters(({ priceFrom, ...criteria }) => {\n        const priceTo = Number(target.value);\n        return {\n          ...criteria,\n          priceFrom: priceTo > priceFrom ? priceFrom : priceTo,\n          priceTo,\n        };\n      }),\n    []\n  );\n\n  console.log({ filters, results });\n\n  const list = useMemo(\n    () =>\n      results\n        .map(({ _created, _updated = _created, ...item }) => ({\n          _title: item.title.toLowerCase(),\n          _price: getPrice(item.price),\n          _stars: Number(item.stars.replace(/[^0-9]/g, \"\")),\n          _created,\n          _updated,\n          _history: {},\n          ...item,\n          ...getMinMaxPrices(item),\n        }))\n        // .filter((item: any) => (item.price.length > 1))\n        .filter(\n          (item: any) =>\n            (item._title.match(filter) || filter.trim() === String(item.id)) &&\n            filters.priceFrom <= item._price &&\n            item._price <= filters.priceTo &&\n            (!filters.brand || [item.brand].includes(filters.brand)) &&\n            (!filters.onlyPromoted || item.proms.length > 0) &&\n            (!filters.onlyReduced || item.price.length > 1)\n        ),\n    [\n      results,\n      filter,\n      filters.brand,\n      filters.priceFrom,\n      filters.priceTo,\n      filters.onlyPromoted,\n      filters.onlyReduced,\n    ]\n  );\n\n  const sorted = useMemo(\n    () =>\n      list.sort((a, b) =>\n        a[sortBy] === b[sortBy]\n          ? a._created > b._created\n            ? 1\n            : -1\n          : SORT_BY[sortBy] * (a[sortBy] > b[sortBy] ? 1 : -1)\n      ),\n    [list, sortBy]\n  );\n\n  return (\n    <div>\n      <fieldset>\n        <label>\n          <span>Search</span>\n          <input\n            type=\"search\"\n            value={filters.search}\n            onChange={useCallback<ChangeEventHandler<HTMLInputElement>>(\n              ({ target }) =>\n                setFilters((filters) => ({\n                  ...filters,\n                  search: target.value,\n                })),\n              []\n            )}\n          />\n        </label>\n        <label>\n          <span>Brand</span>\n          <select\n            value={filters.brand}\n            onChange={useCallback<ChangeEventHandler<HTMLSelectElement>>(\n              ({ target }) =>\n                setFilters((filters) => ({\n                  ...filters,\n                  brand: target.value,\n                })),\n              []\n            )}\n          >\n            {options.brand.map((value) => (\n              <option key={value} value={value}>\n                {value}\n              </option>\n            ))}\n          </select>\n        </label>\n        <label>\n          <span>Sort</span>\n          <select\n            value={sortBy}\n            onChange={useCallback<ChangeEventHandler<HTMLSelectElement>>(\n              ({ target }) => setSortBy(target.value as keyof typeof SORT_BY),\n              []\n            )}\n          >\n            {Object.entries(SORT_BY).map(([value, label]) => (\n              <option key={value} value={value}>\n                {value}\n              </option>\n            ))}\n          </select>\n        </label>\n        <div>\n          <label>\n            <span>Price From</span>\n            <input\n              type=\"range\"\n              list=\"price-list\"\n              min={PRICE_LIST[0]}\n              max={PRICE_LIST[PRICE_LIST.length - 1]}\n              value={filters.priceFrom}\n              onChange={onChangePriceFrom}\n            />\n            <datalist id=\"price-list\">\n              {PRICE_LIST.map((value) => (\n                <option\n                  key={value}\n                  value={value}\n                  label={\n                    [0, 100000, 200000, 300000, 400000, 500000].includes(value)\n                      ? `${value} pln`\n                      : undefined\n                  }\n                ></option>\n              ))}\n            </datalist>\n          </label>\n          <label>\n            <span>Price To</span>\n            <input\n              type=\"range\"\n              list=\"price-list\"\n              min={PRICE_LIST[0]}\n              max={PRICE_LIST[PRICE_LIST.length - 1]}\n              value={filters.priceTo}\n              onChange={onChangePriceTo}\n            />\n            <span>{`${filters.priceFrom}-${filters.priceTo} z≈Ç`}</span>\n          </label>\n          <label>\n            <input\n              type=\"checkbox\"\n              checked={filters.onlyPromoted}\n              onChange={useCallback<ChangeEventHandler<HTMLInputElement>>(\n                ({ target }) =>\n                  setFilters((filters) => ({\n                    ...filters,\n                    onlyPromoted: target.checked,\n                  })),\n                []\n              )}\n            />\n            <span>Only Promoted</span>\n          </label>\n          <label>\n            <input\n              type=\"checkbox\"\n              checked={filters.onlyReduced}\n              onChange={useCallback<ChangeEventHandler<HTMLInputElement>>(\n                ({ target }) =>\n                  setFilters((filters) => ({\n                    ...filters,\n                    onlyReduced: target.checked,\n                  })),\n                []\n              )}\n            />\n            <span>Only Reduced</span>\n          </label>\n        </div>\n      </fieldset>\n      <div>{`Found ${list.length} products out of a total of ${results.length}`}</div>\n      <ol>\n        {sorted.slice(0, 100).map(({ images, srcSet, ...item }) => (\n          <li key={item.id} className={styles.Row}>\n            {/* <pre>{JSON.stringify(item.price, null, 2)}</pre> */}\n            <Gallery\n              className={styles.Gallery}\n              images={images}\n              srcSet={srcSet}\n            />\n            <h3>\n              <Link href={item.url}>{item.title}</Link>\n            </h3>\n            <h4>{item.brand}</h4>\n            {item.label && <div>{item.label.join(\" | \")}</div>}\n            <Compare item={item} />\n            <Details item={item} />\n            <History\n              history={Object.entries(item._history).reverse()}\n              item={item}\n            />\n            {item.reviews && <Reviews reviews={item.reviews} />}\n          </li>\n        ))}\n      </ol>\n    </div>\n  );\n}\n\nconst HISTORY_LIMIT = 1;\n\nfunction History({ history, item }: { history: any[]; item: unknown }) {\n  const [more, setMore] = useState(() =>\n    history.length > HISTORY_LIMIT ? false : true\n  );\n\n  return (\n    <div className={styles.History}>\n      {(more ? history : history.slice(0, HISTORY_LIMIT)).map(\n        ([time, prev], key, list) => (\n          <Details\n            key={key}\n            item={prev}\n            prev={key > 0 ? list[key - 1][1] : item}\n            time={Number(time)}\n          />\n        )\n      )}\n      {more === false && (\n        <Link onClick={(e) => (e.preventDefault(), setMore(true))}>\n          Show more...\n        </Link>\n      )}\n    </div>\n  );\n}\n\nfunction Details({\n  item,\n  prev,\n  time = item._updated || item._created,\n}: {\n  item: Omit<ProductItem, \"images\">;\n  prev?: any;\n  time?: number;\n}) {\n  return (\n    <div className={cx(styles.Details, prev && styles.separator)}>\n      <div className={styles.Sidebar}>\n        {time && (\n          <div className={styles.Date}>{format(time, \"yyyy-MM-dd HH:mm\")}</div>\n        )}\n        <h5>{item.price.join(\" \")}</h5>\n        <div\n          className={cx(\n            styles.Feature,\n            prev && prev.stars !== item.stars && styles.changed\n          )}\n        >\n          {item.stars}\n        </div>\n      </div>\n      {item.proms && (\n        <div\n          className={cx(\n            styles.Feature,\n            prev && prev.proms !== item.proms && styles.changed\n          )}\n        >\n          {item.proms.join(\" | \")}\n        </div>\n      )}\n      <ul\n        className={cx(\n          styles.Feature,\n          prev &&\n            prev.links.join(\":\") !== item.links.join(\":\") &&\n            styles.changed\n        )}\n      >\n        {item.links.map((link, key) => (\n          <li key={key}>{link}</li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nfunction Reviews({ reviews }: { reviews: ReviewItem[] }) {\n  const [expand, setExpand] = useState(false);\n\n  return (\n    <div>\n      <div>\n        {/* {`Found ${list.length} vehicles out of a total of ${results.length}`}{\" \"} */}\n        <Link\n          onClick={(e) => (e.preventDefault(), setExpand((expand) => !expand))}\n        >\n          {expand ? \"Hide reviews\" : \"Show reviews\"}\n        </Link>\n      </div>\n      {/* {expand && <pre>{JSON.stringify(reviews, null, 2)}</pre>} */}\n      {expand && (\n        <ul>\n          {reviews.map(({ author, body, date, rating = \"-\" }, key) => (\n            <li key={key}>\n              <div>\n                <b>\n                  {date}, {author} ({rating})\n                </b>\n              </div>\n              <div>{body}</div>\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n\nexport default function Section() {\n  return (\n    <div className={styles.Section}>\n      <h2>Products</h2>\n      <Data />\n    </div>\n  );\n}\n","import { useEffect, useRef, useState } from \"react\";\n\nexport default function useDebounce(search) {\n  const [filter, setFilter] = useState(search);\n\n  const r = useRef();\n\n  useEffect(() => {\n    clearTimeout(r.current);\n    r.current = setTimeout(() => setFilter(search.toLowerCase()), 400);\n    return () => {\n      clearTimeout(r.current);\n    };\n  }, [search]);\n\n  return [filter];\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".KUxoC6psSrrMeYM5oAlM{color:purple}.KUxoC6psSrrMeYM5oAlM h4{margin:.5em 0}.KUxoC6psSrrMeYM5oAlM h5{margin:.25em 0}.mfYsAqyyqNlAHcqIZRYo{clear:both}.IUsVGkhlVQfyeVKDBe0W{float:left;width:200px;height:150px}.oYFC57M7QUXHd0bHx90u{clear:both}.oYFC57M7QUXHd0bHx90u .d4EGmd7WGzC6jR642U4i{float:right;text-align:right;margin:0 2em}.oYFC57M7QUXHd0bHx90u .hCevawnmB_dy9ljh4Xeg.WHvJJI0E40Qb_2xC6kaz{color:#8a2be2}.oYFC57M7QUXHd0bHx90u.eCohJhUTkuxKnSmXSCp6{border-top:1px solid #d3d3d3;margin-top:.5em;padding-top:.5em}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/containers/Products/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,YAAA,CACA,yBACE,aAAA,CAEF,yBACE,cAAA,CAGJ,sBACE,UAAA,CAEF,sBACE,UAAA,CACA,WAAA,CACA,YAAA,CAEF,sBACE,UAAA,CACA,4CACE,WAAA,CACA,gBAAA,CACA,YAAA,CAGA,iEACE,aAAA,CAGJ,2CACE,4BAAA,CACA,eAAA,CACA,gBAAA\",\"sourcesContent\":[\".Section {\\n  color: purple;\\n  h4 {\\n    margin: 0.5em 0;\\n  }\\n  h5 {\\n    margin: 0.25em 0;\\n  }\\n}\\n.Row {\\n  clear: both;\\n}\\n.Gallery {\\n  float: left;\\n  width: 200px;\\n  height: 150px;\\n}\\n.Details {\\n  clear: both;\\n  .Sidebar {\\n    float: right;\\n    text-align: right;\\n    margin: 0 2em;\\n  }\\n  .Feature {\\n    &.changed {\\n      color: blueviolet;\\n    }\\n  }\\n  &.separator {\\n    border-top: 1px solid lightgray;\\n    margin-top: 0.5em;\\n    padding-top: 0.5em;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"KUxoC6psSrrMeYM5oAlM\",\n\t\"Row\": \"mfYsAqyyqNlAHcqIZRYo\",\n\t\"Gallery\": \"IUsVGkhlVQfyeVKDBe0W\",\n\t\"Details\": \"oYFC57M7QUXHd0bHx90u\",\n\t\"Sidebar\": \"d4EGmd7WGzC6jR642U4i\",\n\t\"Feature\": \"hCevawnmB_dy9ljh4Xeg\",\n\t\"changed\": \"WHvJJI0E40Qb_2xC6kaz\",\n\t\"separator\": \"eCohJhUTkuxKnSmXSCp6\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function debounceTime(dueTime, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return operate(function (source, subscriber) {\n        var activeTask = null;\n        var lastValue = null;\n        var lastTime = null;\n        var emit = function () {\n            if (activeTask) {\n                activeTask.unsubscribe();\n                activeTask = null;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        function emitWhenIdle() {\n            var targetTime = lastTime + dueTime;\n            var now = scheduler.now();\n            if (now < targetTime) {\n                activeTask = this.schedule(undefined, targetTime - now);\n                subscriber.add(activeTask);\n                return;\n            }\n            emit();\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            lastValue = value;\n            lastTime = scheduler.now();\n            if (!activeTask) {\n                activeTask = scheduler.schedule(emitWhenIdle, dueTime);\n                subscriber.add(activeTask);\n            }\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = activeTask = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounceTime.js.map"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","SORT_BY","title","brand","_price","_stars","_created","_updated","PRICE_LIST","asset","createAsset","version","fetch","res","json","getPrice","price","Number","length","reverse","replace","getMinMaxPrices","_history","Object","entries","Date","now","reduce","result","assign","priceMin","priceMax","priceNow","formatPrice","Intl","NumberFormat","minimumFractionDigits","format","priceChange","after","maximumFractionDigits","Compare","item","JSON","stringify","Data","results","read","useMemo","concat","map","filter","Boolean","value","index","array","indexOf","sort","a","b","localeCompare","useState","category","search","onlyPromoted","onlyReduced","priceFrom","priceTo","filters","setFilters","useDebounce","keys","pop","sortBy","setSortBy","onChangePriceFrom","useCallback","target","criteria","onChangePriceTo","console","log","list","_title","toLowerCase","stars","match","trim","String","id","includes","proms","sorted","type","onChange","key","min","max","label","checked","slice","images","srcSet","className","styles","Gallery","Link","href","url","join","Details","History","history","reviews","Reviews","more","setMore","time","prev","onClick","e","preventDefault","cx","links","link","expand","setExpand","author","body","date","rating","Section","setFilter","r","useRef","useEffect","clearTimeout","current","setTimeout","___CSS_LOADER_EXPORT___","push","module","locals","debounceTime","dueTime","scheduler","source","subscriber","activeTask","lastValue","lastTime","emit","unsubscribe","next","emitWhenIdle","targetTime","this","schedule","add","subscribe","complete"],"sourceRoot":""}